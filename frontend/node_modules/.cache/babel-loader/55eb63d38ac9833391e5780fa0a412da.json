{"ast":null,"code":"var _jsxFileName = \"/home/gilberto/ENGSOFT/Web2/src/pages/Login.js\";\nimport React, { Component } from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nclass Login extends Component {\n  constructor() {\n    super();\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleSignUpSubmit = this.handleSignUpSubmit.bind(this);\n    this.handleEmailChange = this.handleEmailChange.bind(this);\n    this.handlePasswordChange = this.handlePasswordChange.bind(this);\n    this.state = {\n      username: undefined,\n      email: undefined,\n      password: undefined,\n      signUp: {\n        success: undefined,\n        message: undefined\n      },\n      logged: false,\n      users: undefined,\n      error: undefined\n    };\n  }\n\n  componentDidMount() {\n    this.verifytoken();\n  }\n\n  verifytoken() {\n    let url = 'http://localhost:3001/auth/verifytoken';\n    let token = localStorage.getItem('DD101_TOKEN');\n\n    if (!token) {\n      this.setState({\n        error: 'No token defined. Please Login.'\n      });\n      return;\n    }\n\n    fetch(url, {\n      method: \"GET\",\n      body: undefined,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"authorization\": `Bearer ${token}`\n      }\n    }).then(response => response.json()).then(responseJson => {\n      if (responseJson.success) {\n        this.setState({\n          logged: responseJson.success,\n          error: undefined\n        });\n        this.loadUsers();\n      } else {\n        this.setState({\n          error: responseJson.error.message\n        });\n      }\n    }).catch(err => this.setState({\n      error: err\n    }));\n  }\n\n  loadUsers() {\n    let url = 'http://localhost:3001/users/listusers';\n    let token = localStorage.getItem('DD101_TOKEN');\n\n    if (!token) {\n      this.setState({\n        error: 'No token defined. Please Login.'\n      });\n      return;\n    }\n\n    fetch(url, {\n      method: \"POST\",\n      body: undefined,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"authorization\": `Bearer ${token}`\n      }\n    }).then(response => response.json()).then(responseJson => {\n      this.setState({\n        users: responseJson.data,\n        error: undefined\n      });\n    }).catch(err => this.setState({\n      error: err\n    }));\n  }\n\n  showAuthorizedArea() {\n    if (this.state.logged) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-primary btn-block\",\n        \"data-toggle\": \"modal\",\n        \"data-target\": \"#authenticatedModal\",\n        \"data-whatever\": \"@mdo\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 21\n        }\n      }, \"Call Authenticated only API\"), /*#__PURE__*/React.createElement(\"small\", {\n        id: \"emailHelp\",\n        className: \"form-text text-muted\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 21\n        }\n      }, \"Only registered and logged users can call and see the list. Plese click the button above to call the API.\"));\n    }\n  }\n  /*\n  Register Form area\n  */\n\n\n  handleSignUpSubmit(e) {\n    e.preventDefault();\n    let dataToSend = {\n      userData: {\n        username: this.refs.username.value,\n        email: this.refs.email.value,\n        password: this.refs.password.value\n      }\n    };\n    let url = 'http://localhost:3001/users/register';\n    fetch(url, {\n      method: \"POST\",\n      body: JSON.stringify(dataToSend),\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(response => response.json()).then(responseJson => {\n      console.log(responseJson);\n\n      if (responseJson.success) {\n        this.setState({\n          signUp: {\n            success: true,\n            message: responseJson.message\n          }\n        });\n      } else {\n        this.setState({\n          signUp: {\n            success: false,\n            message: responseJson.message\n          }\n        });\n      }\n    }).catch(err => console.log('Error ', err));\n    this.refs.username.value = '';\n    this.refs.email.value = '';\n    this.refs.password.value = '';\n  }\n  /*\n  Login Form area\n  */\n\n\n  handleSubmit(e) {\n    e.preventDefault();\n    let dataToSend = {\n      userData: {\n        email: this.state.email,\n        password: this.state.password\n      }\n    };\n    console.log(JSON.stringify(dataToSend));\n    let url = 'http://localhost:3001/auth/login';\n    fetch(url, {\n      method: \"POST\",\n      body: JSON.stringify(dataToSend),\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(response => response.json()).then(responseJson => {\n      if (responseJson.success) {\n        localStorage.setItem('DD101_TOKEN', responseJson.token);\n        this.setState({\n          logged: true,\n          error: undefined\n        });\n        this.loadUsers();\n      }\n    }).catch(err => this.setState({\n      error: err\n    }));\n    e.target.reset();\n  }\n\n  handleEmailChange(e) {\n    this.setState({\n      email: e.target.value\n    });\n  }\n\n  handlePasswordChange(e) {\n    this.setState({\n      password: e.target.value\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal fade\",\n      id: \"signupModel\",\n      tabIndex: \"-1\",\n      role: \"dialog\",\n      \"aria-labelledby\": \"signupModelLabel\",\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-dialog\",\n      role: \"document\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      className: \"modal-title\",\n      id: \"signupModelLabel\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 33\n      }\n    }, \"Registration Form\"), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      className: \"close\",\n      \"data-dismiss\": \"modal\",\n      \"aria-label\": \"Close\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 37\n      }\n    }, \"\\xD7\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 29\n      }\n    }, this.state.signUp.success !== undefined ? this.state.signUp.success === true ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"alert alert-success\",\n      role: \"alert\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 45\n      }\n    }, this.state.signUp.message) : /*#__PURE__*/React.createElement(\"div\", {\n      className: \"alert alert-danger\",\n      role: \"alert\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 45\n      }\n    }, this.state.signUp.message) : '', /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.handleSignUpSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"recipient-name\",\n      className: \"form-control-label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 41\n      }\n    }, \"Name\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      ref: \"username\",\n      className: \"form-control\",\n      id: \"username\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 41\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"email\",\n      className: \"form-control-label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 41\n      }\n    }, \"Email\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"email\",\n      ref: \"email\",\n      className: \"form-control\",\n      id: \"email\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 41\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"message-text\",\n      className: \"form-control-label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 41\n      }\n    }, \"Password:\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      ref: \"password\",\n      className: \"form-control\",\n      id: \"password\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 41\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-footer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-secondary\",\n      \"data-dismiss\": \"modal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 41\n      }\n    }, \"Close\"), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 41\n      }\n    }, \"Register\"))))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal fade\",\n      id: \"authenticatedModal\",\n      tabIndex: \"-1\",\n      role: \"dialog\",\n      \"aria-labelledby\": \"authenticatedModalLabel\",\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-dialog\",\n      role: \"document\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      className: \"modal-title\",\n      id: \"authenticatedModalLabel\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 33\n      }\n    }, \"Only Authenticated Users can see this list!\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"list-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 33\n      }\n    },\n    /**\n     * List the users when authenticated\n     */\n    this.state.users !== undefined && this.error === undefined ? this.state.users.map(user => /*#__PURE__*/React.createElement(\"a\", {\n      key: user.email,\n      href: \"#\",\n      className: \"list-group-item list-group-item-action flex-column align-items-start\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 49\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex w-100 justify-content-between\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 53\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      className: \"mb-1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 57\n      }\n    }, \"Name: \", user.name), /*#__PURE__*/React.createElement(\"small\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 57\n      }\n    }, \"01/09/2017\")), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"mb-1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 53\n      }\n    }, \"E-mail: \", user.email), /*#__PURE__*/React.createElement(\"small\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 53\n      }\n    }, \"Password (Should never do that)\"))) : this.state.error)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-footer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-secondary btn-block\",\n      \"data-dismiss\": \"modal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 33\n      }\n    }, \"Close\"))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      style: {\n        paddingTop: '50px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card\",\n      style: {\n        width: '20rem',\n        boxShadow: '0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"card-img-top\",\n      src: \"https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAV3AAAAJDEwODQxZWI3LTYyMmUtNDEzZS04YjNlLTNmNzA0YjY0OTMwMg.jpg\",\n      alt: \"Card image cap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"exampleInputEmail1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 41\n      }\n    }, \"Email address\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"email\",\n      onChange: this.handleEmailChange,\n      className: \"form-control\",\n      id: \"exampleInputEmail1\",\n      \"aria-describedby\": \"emailHelp\",\n      placeholder: \"Enter email\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 41\n      }\n    }), /*#__PURE__*/React.createElement(\"small\", {\n      id: \"emailHelp\",\n      className: \"form-text text-muted\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 41\n      }\n    }, \"We'll never share your email with anyone else.\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"exampleInputPassword1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 41\n      }\n    }, \"Password\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      onChange: this.handlePasswordChange,\n      className: \"form-control\",\n      id: \"exampleInputPassword1\",\n      placeholder: \"Password\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 41\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-check\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"form-check-label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"checkbox\",\n      className: \"form-check-input\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 45\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 45\n      }\n    }, \"Remember me\"))), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-primary btn-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 37\n      }\n    }, \"Login\"), /*#__PURE__*/React.createElement(\"small\", {\n      id: \"emailHelp\",\n      className: \"form-text text-muted\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 37\n      }\n    }, \"If you are not registered. Plese \", /*#__PURE__*/React.createElement(\"a\", {\n      href: \"#\",\n      \"data-toggle\": \"modal\",\n      \"data-target\": \"#signupModel\",\n      \"data-whatever\": \"@mdo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 125\n      }\n    }, \"Signup\")), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 37\n      }\n    }), this.showAuthorizedArea())))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 21\n      }\n    })));\n  }\n\n}\n\nLogin.displayName = 'ui-LoginForm';\nexport default Login;","map":{"version":3,"sources":["/home/gilberto/ENGSOFT/Web2/src/pages/Login.js"],"names":["React","Component","Login","constructor","handleSubmit","bind","handleSignUpSubmit","handleEmailChange","handlePasswordChange","state","username","undefined","email","password","signUp","success","message","logged","users","error","componentDidMount","verifytoken","url","token","localStorage","getItem","setState","fetch","method","body","headers","then","response","json","responseJson","loadUsers","catch","err","data","showAuthorizedArea","e","preventDefault","dataToSend","userData","refs","value","JSON","stringify","console","log","setItem","target","reset","render","map","user","name","paddingTop","width","boxShadow","displayName"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nclass Login extends Component {\n\n    constructor() {\n        super();\n        this.handleSubmit = this.handleSubmit.bind(this);\n        this.handleSignUpSubmit = this.handleSignUpSubmit.bind(this);\n        this.handleEmailChange = this.handleEmailChange.bind(this);\n        this.handlePasswordChange = this.handlePasswordChange.bind(this);\n\n        this.state = {\n            username: undefined,\n            email: undefined,\n            password: undefined,\n            signUp: {\n                success: undefined,\n                message: undefined\n            },\n            logged: false,\n            users: undefined,\n            error: undefined\n        }\n    }\n\n    static displayName = 'ui-LoginForm'\n\n    componentDidMount() {\n        this.verifytoken();\n    }\n\n    verifytoken() {\n        let url = 'http://localhost:3001/auth/verifytoken';\n        let token = localStorage.getItem('DD101_TOKEN');\n\n        if (!token) {\n            this.setState({\n                error: 'No token defined. Please Login.'\n            })\n            return\n        }\n\n        fetch(url, {\n            method: \"GET\",\n            body: undefined,\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"authorization\": `Bearer ${token}`\n            }\n        }).then(response => response.json())\n            .then(responseJson => {\n                if (responseJson.success) {\n                    this.setState({\n                        logged: responseJson.success,\n                        error: undefined\n                    })\n                    this.loadUsers()\n                } else {\n                    this.setState({\n                        error: responseJson.error.message\n                    })\n                }\n            }).catch(err => this.setState({ error: err }));\n    }\n\n    loadUsers() {\n        let url = 'http://localhost:3001/users/listusers';\n        let token = localStorage.getItem('DD101_TOKEN');\n        if (!token) {\n            this.setState({\n                error: 'No token defined. Please Login.'\n            })\n            return\n        }\n\n        fetch(url, {\n            method: \"POST\",\n            body: undefined,\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"authorization\": `Bearer ${token}`\n            }\n        }).then(response => response.json())\n            .then(responseJson => {\n                this.setState({\n                    users: responseJson.data,\n                    error: undefined\n                })\n            }).catch(err => this.setState({ error: err }));\n    }\n\n\n    showAuthorizedArea() {\n        if (this.state.logged) {\n            return (\n                <div>\n                    <button type=\"button\" className=\"btn btn-primary btn-block\" data-toggle=\"modal\" data-target=\"#authenticatedModal\" data-whatever=\"@mdo\" >Call Authenticated only API</button>\n                    <small id=\"emailHelp\" className=\"form-text text-muted\">Only registered and logged users can call and see the list. Plese click the button above to call the API.</small>\n                </div>\n            );\n        }\n    }\n\n    /*\n    Register Form area\n    */\n\n    handleSignUpSubmit(e) {\n        e.preventDefault();\n        let dataToSend = {\n            userData: {\n                username: this.refs.username.value,\n                email: this.refs.email.value,\n                password: this.refs.password.value\n            }\n        };\n\n\n        let url = 'http://localhost:3001/users/register';\n\n        fetch(url, {\n            method: \"POST\",\n            body: JSON.stringify(dataToSend),\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        }).then(response => response.json())\n            .then(responseJson => {\n                console.log(responseJson)\n                if (responseJson.success) {\n                    this.setState({\n                        signUp: {\n                            success: true,\n                            message: responseJson.message\n                        }\n                    });\n                } else {\n                    this.setState({\n                        signUp: {\n                            success: false,\n                            message: responseJson.message\n                        }\n                    });\n                }\n            }).catch(err => console.log('Error ', err));\n\n        this.refs.username.value = '';\n        this.refs.email.value = '';\n        this.refs.password.value = '';\n\n    }\n\n\n\n    /*\n    Login Form area\n    */\n\n    handleSubmit(e) {\n        e.preventDefault();\n        let dataToSend = {\n            userData: {\n                email: this.state.email,\n                password: this.state.password\n            }\n        };\n        console.log(JSON.stringify(dataToSend))\n        let url = 'http://localhost:3001/auth/login';\n\n        fetch(url, {\n            method: \"POST\",\n            body: JSON.stringify(dataToSend),\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        }).then(response => response.json())\n            .then(responseJson => {\n                if (responseJson.success) {\n                    localStorage.setItem('DD101_TOKEN', responseJson.token);\n                    this.setState({\n                        logged: true,\n                        error: undefined\n                    })\n                    this.loadUsers()\n                }\n            }).catch(err => this.setState({ error: err }));\n\n            e.target.reset()\n    }\n\n    handleEmailChange(e) {\n        this.setState({\n            email: e.target.value\n        });\n    }\n\n    handlePasswordChange(e) {\n        this.setState({\n            password: e.target.value\n        });\n    }\n\n    render() {\n        return (\n            <div className=\"container\">\n                {/* Begin Modal Register Form */}\n                <div className=\"modal fade\" id=\"signupModel\" tabIndex=\"-1\" role=\"dialog\" aria-labelledby=\"signupModelLabel\" aria-hidden=\"true\">\n                    <div className=\"modal-dialog\" role=\"document\">\n                        <div className=\"modal-content\">\n                            <div className=\"modal-header\">\n                                <h5 className=\"modal-title\" id=\"signupModelLabel\">Registration Form</h5>\n                                <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                                    <span aria-hidden=\"true\">&times;</span>\n                                </button>\n                            </div>\n                            <div className=\"modal-body\">\n\n                                {\n                                    this.state.signUp.success !== undefined ? (\n                                        this.state.signUp.success === true ?\n                                            <div className=\"alert alert-success\" role=\"alert\">\n                                                {this.state.signUp.message}\n                                            </div>\n                                            :\n                                            <div className=\"alert alert-danger\" role=\"alert\">\n                                                {this.state.signUp.message}\n                                            </div>\n                                    ) : ''\n                                }\n\n                                <form onSubmit={this.handleSignUpSubmit}>\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"recipient-name\" className=\"form-control-label\">Name</label>\n                                        <input type=\"text\" ref=\"username\" className=\"form-control\" id=\"username\" />\n                                    </div>\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"email\" className=\"form-control-label\">Email</label>\n                                        <input type=\"email\" ref=\"email\" className=\"form-control\" id=\"email\" />\n                                    </div>\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"message-text\" className=\"form-control-label\">Password:</label>\n                                        <input type=\"password\" ref=\"password\" className=\"form-control\" id=\"password\" />\n                                    </div>\n                                    <div className=\"modal-footer\">\n                                        <button type=\"button\" className=\"btn btn-secondary\" data-dismiss=\"modal\">Close</button>\n                                        <button type=\"submit\" className=\"btn btn-primary\">Register</button>\n                                    </div>\n                                </form>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                {/* Begin Modal Register Form */}\n\n                {/* Begin Modal List Authenticad List  */}\n\n                <div className=\"modal fade\" id=\"authenticatedModal\" tabIndex=\"-1\" role=\"dialog\" aria-labelledby=\"authenticatedModalLabel\" aria-hidden=\"true\">\n                    <div className=\"modal-dialog\" role=\"document\">\n                        <div className=\"modal-content\">\n                            <div className=\"modal-header\">\n                                <h5 className=\"modal-title\" id=\"authenticatedModalLabel\">Only Authenticated Users can see this list!</h5>\n                            </div>\n                            <div className=\"modal-body\">\n\n                                <div className=\"list-group\">\n\n                                    {\n                                        /**\n                                         * List the users when authenticated\n                                         */\n                                        (this.state.users !== undefined && this.error === undefined) ? (\n                                            this.state.users.map((user) => (\n                                                <a key={user.email} href=\"#\" className=\"list-group-item list-group-item-action flex-column align-items-start\">\n                                                    <div className=\"d-flex w-100 justify-content-between\">\n                                                        <h5 className=\"mb-1\">Name: {user.name}</h5>\n                                                        <small>01/09/2017</small>\n                                                    </div>\n                                                    <p className=\"mb-1\">E-mail: {user.email}</p>\n                                                    <small>Password (Should never do that)</small>\n                                                </a>\n                                            ))\n                                        ) : this.state.error\n                                    }\n\n\n\n                                </div>\n\n                            </div>\n                            <div className=\"modal-footer\">\n                                <button type=\"button\" className=\"btn btn-secondary btn-block\" data-dismiss=\"modal\">Close</button>\n\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {/* End Modal List Authenticad List */}\n\n\n                {/* Begin Login Form */}\n                <div className=\"row\" style={{ paddingTop: '50px' }}>\n                    <div className=\"col\">\n                    </div>\n                    <div className=\"col\">\n                        <div className=\"card\" style={{ width: '20rem', boxShadow: '0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)' }}>\n                            <img className=\"card-img-top\" src=\"https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAV3AAAAJDEwODQxZWI3LTYyMmUtNDEzZS04YjNlLTNmNzA0YjY0OTMwMg.jpg\" alt=\"Card image cap\" />\n                            <div className=\"card-body\">\n                                <form onSubmit={this.handleSubmit}>\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"exampleInputEmail1\">Email address</label>\n                                        <input type=\"email\" onChange={this.handleEmailChange} className=\"form-control\" id=\"exampleInputEmail1\" aria-describedby=\"emailHelp\" placeholder=\"Enter email\" />\n                                        <small id=\"emailHelp\" className=\"form-text text-muted\">We'll never share your email with anyone else.</small>\n                                    </div>\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"exampleInputPassword1\">Password</label>\n                                        <input type=\"password\" onChange={this.handlePasswordChange} className=\"form-control\" id=\"exampleInputPassword1\" placeholder=\"Password\" />\n                                    </div>\n                                    <div className=\"form-check\">\n                                        <label className=\"form-check-label\">\n                                            <input type=\"checkbox\" className=\"form-check-input\" />\n                                            <span>Remember me</span>\n                                        </label>\n                                    </div>\n                                    <button type=\"submit\" className=\"btn btn-primary btn-block\">Login</button>\n                                    <small id=\"emailHelp\" className=\"form-text text-muted\">If you are not registered. Plese <a href=\"#\" data-toggle=\"modal\" data-target=\"#signupModel\" data-whatever=\"@mdo\" >Signup</a></small>\n                                    <br />\n                                    {\n                                        this.showAuthorizedArea()\n                                    }\n                                </form>\n\n\n                            </div>\n                        </div>\n\n                    </div>\n                    <div className=\"col\">\n                    </div>\n                </div>\n                {/* End Login Form */}\n            </div>\n        );\n    }\n}\nexport default Login;"]},"metadata":{},"sourceType":"module"}